a = [('FANY', 'EXIT', 'for', 'BARTOUX', 'STOP', 'PRADA', 'VUITTON', 'CKET', 'STOP', 'S', 'for', 'EXIT', 'PRADA', 'd', 'ALERIES', 'for', 'Wedding', 'STOP', 'CKET', 'FOSSIL', 'VUITTON', 'S', 'BARTOUX', 'VUITTON', 'STOP', 'BARTOUX', 'ARB', 'd', 'GUCCI', 'RAIL', 'RAIL', 'CKET', '', 'PRADA', 'ALERIES', 'GUCCI', '', '', 'STOP', 'FANY', 'RAIL', 'EXIT', 'FANY', 'Wedding', 'STOP', 'FOSSIL', 'GUCCI', 'S', 'ARB', 'ARB'), ('RAIL', 'ALERIES', 'GUCCI', 'BARTOUX', 'VUITTON', 'PRADA', 'PRADA', 'ALERIES', 'S', 'FANY', 'for', 'CKET', '', 'FOSSIL', 'CKET', 'VUITTON', 'BARTOUX', 'STOP', 'ARB', 'FANY', 'S', 'd', 'PRADA', 'ARB', 'S', 'EXIT', 'VUITTON', 'd', 'FOSSIL', 'RAIL', 'for', 'S', 'FANY', 'STOP', 'VUITTON', 'GUCCI', '', 'S', 'Wedding', 'PRADA', 'VUITTON', 'PRADA', 'S', '', 'GUCCI', 'PRADA', 'CKET', 'EXIT', 'VUITTON', 'Wedding'), ('ARB', '', 'd', 'ARB', 'PRADA', 'FANY', 'FOSSIL', 'FOSSIL', '', 'EXIT', 'VUITTON', 'RAIL', 'ALERIES', 'VUITTON', 'FANY', 'STOP', 'S', '', 'CKET', 'PRADA', 'for', '', 'EXIT', 'FANY', '', 'CKET', 'STOP', 'S', 'd', 'RAIL', 'Wedding', 'PRADA', 'GUCCI', '', 'ALERIES', 'S', 'GUCCI', 'EXIT', 'VUITTON', 'CKET', 'for', 'BARTOUX', 'RAIL', 'ARB', 'GUCCI', 'BARTOUX', 'for', 'STOP', 'Wedding', 'BARTOUX'), ('for', 'ARB', 'BARTOUX', 'FANY', 'GUCCI', 'S', 'RAIL', 'PRADA', 'VUITTON', '', 'FANY', 'ALERIES', 'BARTOUX', 'ALERIES', 'for', 'CKET', 'ARB', 'BARTOUX', 'GUCCI', 'RAIL', 'PRADA', 'EXIT', 'S', 'RAIL', 'd', 'FOSSIL', 'STOP', 'RAIL', 'EXIT', 'CKET', 'FANY', 'CKET', 'd', 'GUCCI', 'VUITTON', 'CKET', '', 'S', 'ARB', 'Wedding', 'CKET', 'STOP', 'RAIL', '', 'STOP', 'RAIL', 'EXIT', 'Wedding', 'CKET', 'FOSSIL'), ('CKET', 'VUITTON', 'Wedding', 'S', 'PRADA', 'RAIL', 'RAIL', 'GUCCI', 'BARTOUX', 'PRADA', '', 'FANY', 'FOSSIL', 'for', 'ALERIES', 'EXIT', 'EXIT', 'for', 'ARB', 'Wedding', 'S', 'CKET', 'GUCCI', 'ARB', 'BARTOUX', 'CKET', 'S', 'd', 'VUITTON', 'STOP', 'RAIL', 'FOSSIL', 'Wedding', 'FANY', 'ALERIES', '', 'd', 'FANY', 'GUCCI', '', 'Wedding', 'FANY', 'Wedding', 'FANY', 'STOP', 'STOP', 'BARTOUX', 'ARB', 'FANY', 'Wedding'), ('ALERIES', 'FOSSIL', 'd', 'for', 'CKET', 'STOP', 'd', '', '', 'FANY', 'VUITTON', 'FANY', 'S', 'VUITTON', 'FOSSIL', 'EXIT', 'Wedding', 'ARB', 'FOSSIL', 'PRADA', 'GUCCI', 'ARB', 'FOSSIL', 'PRADA', 'RAIL', 'ARB', 'BARTOUX', 'CKET', 'GUCCI', 'S', 'RAIL', 'GUCCI', 'S', 'STOP', 'GUCCI', 'BARTOUX', 'ALERIES', 'RAIL', '', 'FOSSIL', 'STOP', 'BARTOUX', 'for', 'FANY', 'GUCCI', 'FOSSIL', 'GUCCI', 'CKET', 'Wedding', 'EXIT'), ('CKET', 'VUITTON', 'CKET', '', 'for', 'd', 'd', 'ALERIES', 'RAIL', 'GUCCI', '', 'BARTOUX', 'S', 'GUCCI', 'FOSSIL', 'ARB', 'for', 'EXIT', 'STOP', 'FANY', 'RAIL', 'FANY', 'FOSSIL', 'EXIT', 'ALERIES', 'PRADA', 'VUITTON', 'Wedding', 'S', 'BARTOUX', 'BARTOUX', 'EXIT', 'FANY', 'S', 'STOP', 'ARB', 'ARB', 'GUCCI', 'ARB', 'RAIL', 'ARB', 'ARB', 'for', '', 'VUITTON', 'PRADA', 'CKET', 'STOP', 'PRADA', 'Wedding'), ('CKET', 'S', 'ARB', '', 'STOP', 'GUCCI', 'FANY', 'CKET', '', 'CKET', 'for', 'S', 'Wedding', 'ARB', 'BARTOUX', 'BARTOUX', 'Wedding', 'PRADA', '', '', 'RAIL', 'VUITTON', 'VUITTON', 'd', 'GUCCI', 'for', 'RAIL', 'EXIT', 'PRADA', 'FANY', '', 'ARB', 'd', 'PRADA', 'EXIT', 'S', 'RAIL', 'FOSSIL', 'BARTOUX', 'STOP', 'ALERIES', 'FANY', 'ALERIES', 'GUCCI', 'STOP', 'EXIT', '', 'VUITTON', 'for', 'FOSSIL'), ('for', 'ARB', 'GUCCI', 'CKET', 'STOP', '', 'FANY', 'ALERIES', 'EXIT', 'for', 'BARTOUX', 'RAIL', 'd', 'ARB', 'EXIT', 'RAIL', '', 'EXIT', 'GUCCI', 'EXIT', 'ALERIES', 'PRADA', 'VUITTON', 'd', 'BARTOUX', 'BARTOUX', 'CKET', 'ALERIES', 'PRADA', '', 'EXIT', 'ALERIES', 'S', 'EXIT', 'BARTOUX', 'BARTOUX', 'S', 'VUITTON', 'FANY', 'CKET', 'ALERIES', 'Wedding', 'ALERIES', 'S', 'FANY', 'Wedding', 'FOSSIL', 'BARTOUX', 'FOSSIL', 'STOP'), ('RAIL', 'ARB', 'EXIT', 'EXIT', 'd', 'BARTOUX', 'd', 'S', 'FOSSIL', 'FANY', 'CKET', 'ALERIES', 'Wedding', 'PRADA', 'FOSSIL', 'd', 'FANY', 'Wedding', 'CKET', 'ARB', 'PRADA', 'GUCCI', 'FANY', 'RAIL', 'for', 'GUCCI', 'BARTOUX', 'ALERIES', 'for', 'STOP', 'for', 'd', 'RAIL', 'for', '', 'd', 'STOP', 'S', 'for', 'VUITTON', 'GUCCI', 'CKET', '', 'STOP', 'd', 'for', '', 'BARTOUX', 'S', 'VUITTON')]

b = [(0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0), (0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0), (0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), (0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0), (0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1), (0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0), (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0), (0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0), (0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0), (0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0)]

import torch

pre = torch.ones((len(a), len(a[0]), 200, 80))
print(pre.shape)

a_final = []
index_list = []
pre_list = []

for ai, bi in zip(a, b):

    index = [i for i, e in enumerate(bi) if e != 0]
    index_list.append(index)
    a_final.append([ai[t] for t in index])

for pre_item, index in zip(pre, index_list):

    pre_list.append(pre_item[index])

for bi, pre_item in zip(b, pre_list):

    print(sum(bi))
    print(pre_item.shape)
